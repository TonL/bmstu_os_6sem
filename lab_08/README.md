# lab_08 (Sockets) - Questions 

Сокет - механизм межпроцессного взаимодействия

- **Через что взаимодействуют сокеты в unix?**
    
    — Через файловую подсистему (специальный файл)
    

- **Через что взаимодействуют сокеты в inet**
    
    — в inet происходит взаимодействие через сетевой адрес (сетевой адрес = адрес компа + порт)
    
    порт - 
    

- **Где можем увидеть созданный нами сокет?**
    
    — В файловой системе (ls -lai)
    

- **Что нужно передавать мультиплексору?**
Мультиплексору нужно передавать 3 множества дескрипторов из-за специфики работы.

- **Что делает системный вызов accept?**

```c
**int accept(int sockfd, void *addr, int *addrlen);**
```

Устанавливает соединение в ответ на запрос клиента и создает копию сокета для того, чтобы исходный сокет мог продолжать прослушивание

Функция ***accept*** создаёт для общения с клиентом новый сокет и возвращает его дескриптор.
Параметр sockfd задаёт слушающий сокет. После вызова он остаётся в слушающем состоянии и может принимать другие соединения. В структуру, на которую ссылается addr, записывается адрес сокета клиента, который установил соединение с сервером. В переменную, адресуемую указателем addrlen, изначально записывается размер структуры; функция accept записывает туда длину, которая реально была использована. Если вас не интересует адрес клиента, вы можете просто передать NULL в качестве второго и третьего параметров.

Просмотр адреса сокета: **sudo ss -tulpn**

- **Какой мультиплексор использовали?**
    
     — select
    
- **Какие аргументы передаёте мультиплексору?** 
    
    ```c
    int select(int n, fd_set *readfds, fd_set *writefds, fd_set *exceptfds, struct timeval *timeout);
    ```
    
    Функция ***select*** работает с тремя множествами дескрипторов, каждое из которых имеет тип ***fd_set***.
    В множество ***readfds*** записываются дескрипторы сокетов, из которых нам требуется читать данные (слушающие сокеты добавляются в это же множество). Множество writefds должно содержать дескрипторы сокетов, в которые мы собираемся писать, а ***exceptfds*** - дескрипторы сокетов, которые нужно контролировать на возникновение ошибки. Если какое-то множество вас не интересуют, вы можете передать вместо указателя на него NULL. Что касается других параметров, в n нужно записать максимальное значение дескриптора по всем множествам плюс единица, а в timeout - величину таймаута.
    
- **Почему мультиплексирование лучше чем ожидание отдельного сокета (примерная формулировка)?**
    
     — Все соединения опрашиваются одновременно, сокращается время блокировки. 
    
- **Как взаимодействуют сокеты AF_UNIX?** 
    
    Через файловое пр-во имен 
    
- **Сделайте, чтобы файл сокета сервера и сокета клиента назывался одинаково (в коде) не пересобираем иначе не сработает** 

- **Что позволяет INADDR_ANY (в сетевых)?** 
    
    — Реализовать на отдельной машине работу распределённой системе. Подключение к любому свободному айпи адресу
    
    **Распределенная система** — это совокупность компьютеров, которые работают вместе, образуя единый компьютер для конечного пользователя. Все эти распределенные машины имеют одно общее состояние и работают одновременно.
    

socket, bind, listen, select, accept - последовательность сервера для inet

Когда вызывается accept? 

Старая копия в режиме прослушивая, новая копия - режим соединения (connected)
